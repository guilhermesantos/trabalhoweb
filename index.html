
<html>
<head>
	<link rel="stylesheet" type="text/css" href="style.css"> 
	<link rel="stylesheet" type="text/css" href="titles.css"> 
	<link rel="stylesheet" type="text/css" href="menus.css"> 
	<link rel="stylesheet" type="text/css" href="forms.css"> 
	<link rel="stylesheet" type="text/css" href="animal_details.css">

	<!--<link rel="stylsheet" type="text/css" href="control_panel.css">-->
	 <meta charset="utf-8"></meta>
</head>
<body>
	<header>
		<h1 class="site_title">%Pet Shop Name%</h1>
	</header>

	<nav>
		<ul class="horizontal_menu">

		</ul>
	</nav>
<!--
	<nav>
		<ul class="side_menu">
			<li class="side_menu_item">Funcionalidade 1</li>
			<li class="side_menu_item">Funcionalidade 2</li>
			<li class="side_menu_item">Funcionalidade 3</li>
			<li class="side_menu_item">Funcionalidade 4</li>
			<li class="side_menu_item">Funcionalidade 5</li>
			<li class="side_menu_item">Funcionalidade 6</li>
		</ul>
	</nav>
-->
	<main class="content">

	</main>
 	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="site_content.js"></script>

 	<script type="text/javascript">

 	const loginData = [
		{ usuario: "admin", nome: "Bill", senha: "password", email: "bill@company.com", telefone: "9999-9999", cidade:"são carlos", rua: "whatever", bairro: "saida da mat", isAdmin: true },
		{ usuario: "client", nome: "Bill", senha: "1234", email: "bill@company.com", telefone: "9999-9999", cidade:"são carlos", rua: "whatever", bairro: "saida da mat", isAdmin: false }
	];

 	var indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB || window.shimIndexedDB;
 	 	console.log(indexedDB);

/* 	var request = indexedDB.open("Database", 2);
 	console.log(request);
 	var loginObjectStore;
 	var db;
 	var objectStore;
 	request.onupgradeneeded = function(event) {
		let db = event.target.result;
		console.log("passei aqui 2");
		let objectStore = db.createObjectStore("accounts", { keyPath: "usuario" });

		objectStore.createIndex("nome", "nome", { unique: false });
		objectStore.createIndex("senha", "senha", { unique: false });
		objectStore.createIndex("telefone", "telefone", { unique: false });
		objectStore.createIndex("email", "email", { unique: true });
		objectStore.createIndex("cidade", "cidade", { unique: false });
		objectStore.createIndex("rua", "rua", { unique: false });
		objectStore.createIndex("bairro", "bairro", { unique: false });
		objectStore.createIndex("isAdmin", "isAdmin", { unique: false });

		objectStore.transaction.oncomplete = function(event) {
			// Store values in the newly created objectStore.
			loginObjectStore = db.transaction("accounts", "readwrite").objectStore("accounts");
			for (let i in loginData) {
			  loginObjectStore.add(loginData[i]);
			}
		};
		console.log("passei aqui 3");
		//db.close();
	};*/

	const dbName = "clientes";
	const DadosClientes = [
	  { ssn: "444-44-4444", nome: "Bill", idade: 35, email: "bill@company.com" },
	  { ssn: "555-55-5555", nome: "Donna", idade: 32, email: "donna@home.org" }
	];
	var request = indexedDB.deleteDatabase(dbName);
	var request = indexedDB.open(dbName, 2);
	var connection;


	request.onerror = function(event) {
	  // Tratar erros.
	};
	request.onupgradeneeded = function(event) {
	  var db = event.target.result;

	  // Cria um objectStore para conter a informação sobre nossos clientes. Nós vamos
	  // usar "ssn" como key path porque sabemos que é único;
	  var objectStore = db.createObjectStore("clientes", { keyPath: "ssn" });

	  // Cria um índice para buscar clientes pelo nome. Podemos ter nomes
	  // duplicados, então não podemos usar como índice único.
	  objectStore.createIndex("nome", "nome", { unique: false });

	  // Cria um índice para buscar clientes por email. Queremos ter certeza
	  // que não teremos 2 clientes com o mesmo e-mail;
	  objectStore.createIndex("email", "email", { unique: true });

	  // Usando transação oncomplete para afirmar que a criação do objectStore 
	  // é terminada antes de adicionar algum dado nele.
	  console.log("passou aqui");
	  objectStore.transaction.oncomplete = function(event) {
	  	console.log("passou aqui tbm");
	    // Armazenando valores no novo objectStore.
	    var clientesObjectStore = db.transaction("clientes", "readwrite").objectStore("clientes");
	    for (var i in DadosClientes) {
	    	var aux = clientesObjectStore.add(DadosClientes[i]);
			console.log(clientesObjectStore.add(DadosClientes[i]));
	    }
	  }
	};

	request.onsuccess = function(event) {

		console.log("Conexao obtida com sucesso");
		connection = event.target.result;
		var clientesObjectStore = connection.transaction("clientes", "readwrite").objectStore("clientes");
	    for (var i in DadosClientes) {
	      clientesObjectStore.add(DadosClientes[i]);
		  //console.log(clientesObjectStore.get(DadosClientes[i]));
	    }
	};


 	let client = false;
	$(document).ready(
		function() {
			if(!client) {
				$(".horizontal_menu").html(horizontalMenu.index)
				$(".content").html(siteContent.index);
			}
		}
	);

	function loginClick() {
		var tx = connection.transaction("clientes", "readonly");
    	var objectStore = tx.objectStore("clientes");
    	var request = objectStore.getAll();
    	request.onsuccess = function(event) {
    		//alert(request.result.name);
    		console.log(request.result.name);
    		/*if(document.getElementById("login_username").value == request.result.name) {
    			alert("amém deu certo");
				$(".horizontal_menu").html(horizontalMenu.client);
				$(".content").html(siteContent.client.agendarHorario);
				$("header").append(siteContent.logoutBox);	
			}*/
		};
		//var request = indexedDB.open("Database", 2);
		//console.log(request.result.transaction(["register", "readwrite"]));
		//var transaction = request.result.transaction(["clientes"]);
		//var objectStore = transaction.objectStore("clientes");
		//var request = objectStore.get("444-44-4444");
		//let request = request.loginObjectStore.get(document.getElementById("login_username").value);
/*		request.onerror = function(event) {
			console.log("fk")
		}
		request.onsucess = function(event) {
			//if(document.getElementById("login_password").value == request.result.senha)
				console.log("wow")
		}*/
		//if(document.getElementById("login_username").value == "a") {
			$(".horizontal_menu").html(horizontalMenu.client);
			$(".content").html(siteContent.client.agendarHorario);
			$("header").append(siteContent.logoutBox);	
		//}
	}

	function menuClick(component) {
		switch(component.attributes.tab.value) {
			case "agendarHorario":
				$(".content").html(siteContent.client.agendarHorario);
				break;
			case "comprarProduto":
				$(".content").html(siteContent.client.comprarProduto);
				break;
			case "editarRegistro":
				$(".content").html(siteContent.client.editarRegistro);
				break;
			case "gerenciarAnimais":
				$(".content").html(siteContent.client.gerenciarAnimais);
				break;
		}		
	}

	function logout() {
		console.log("chamou logout");
		$("#user_login_box").remove();
		$(".content").html(siteContent.index);
		$(".horizontal_menu").html(horizontalMenu.index);
	}

	function animalDetailsClick() {
		$(".content").html(siteContent.client.visualizarAnimal);
	}

	function showAnimalRegisterForm() {
		$(".content").html(siteContent.client.gerenciarAnimaisRegisterVisible);
	}

	function hideAnimalRegisterForm() {
		$(".content").html(siteContent.client.gerenciarAnimais);
	}

	var slideIndex = 1;
	showDivs(slideIndex);

	function plusDivs(n) {
	    showDivs(slideIndex += n);
	}

	function showDivs(n) {
	    var i;
	    var x = document.getElementsByClassName("mySlides");
	    if (n > x.length) {slideIndex = 1}
	    if (n < 1) {slideIndex = x.length} ;
	    for (i = 0; i < x.length; i++) {
	        x[i].style.display = "none";
	    }
	    x[slideIndex-1].style.display = "block";
	}


 	</script>
	
	<footer>
		Copyright
		Icons by Freepik of flaticon.com and Alfredo Hernandez of alfredocreates.com
	</footer>

</body>
</html>
